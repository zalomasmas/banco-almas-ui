<div class="new-page">
  <div class="container py-4">
    <div class="top-bar d-flex align-items-center mb-2">
      <a class="back" routerLink="/app/nuevo/privacidad-fecha"><span class="material-icons">arrow_back</span></a>
      <div class="brand ms-2">Crear nuevo recuerdo</div>
    </div>
    <div class="media-panel">
      <div class="panel-content" *ngIf="currentAttachment as att; else emptyPanel">
        <img *ngIf="att.type==='image'" [src]="att.url" alt="image" />
        <video *ngIf="att.type==='video'" [src]="att.url" controls></video>
        <audio *ngIf="att.type==='audio'" [src]="att.url" controls></audio>
      </div>
      <ng-template #emptyPanel>
        <div class="empty">
          <span class="material-icons">photo_camera</span>
        </div>
      </ng-template>
      <div class="overlay-tools">
        <button class="tool" type="button" (click)="galleryInput.click()"><span class="material-icons">image</span></button>
        <button class="tool" type="button" (click)="cameraInput.click()"><span class="material-icons">photo_camera</span></button>
        <button class="tool" type="button" (click)="videoInput.click()"><span class="material-icons">videocam</span></button>
        <button class="tool" type="button" (click)="audioInput.click()"><span class="material-icons">music_note</span></button>
        <button class="tool" type="button" (click)="toggleRecording()"><span class="material-icons">{{ isRecording ? 'stop' : 'mic' }}</span></button>
        <input #galleryInput class="d-none" type="file" accept="image/*" multiple (change)="onImages($event)" />
        <input #cameraInput class="d-none" type="file" accept="image/*" capture="environment" (change)="onImages($event)" />
        <input #videoInput class="d-none" type="file" accept="video/*" (change)="onVideos($event)" />
        <input #audioInput class="d-none" type="file" accept="audio/*" (change)="onAudioFiles($event)" />
      </div>
      <div class="overlay-title" [class.collapsed]="!titleActive && !wiz.title">
        <input
          class="overlay-input"
          placeholder="Titulo"
          [(ngModel)]="wiz.title"
          (focus)="titleActive=true"
          (blur)="titleActive=!!wiz.title"
        />
      </div>
      <div class="overlay-text" [class.collapsed]="!textActive && !wiz.text">
        <textarea
          class="overlay-textarea"
          rows="3"
          placeholder="Â¿Que deseas recordar hoy?"
          [(ngModel)]="wiz.text"
          (focus)="textActive=true"
          (blur)="textActive=!!wiz.text"
        ></textarea>
      </div>
    </div>

    <a class="cta" routerLink="/app/nuevo/confirmacion">
      <span>Guardar recuerdo</span>
      <span class="action"><span class="material-icons">arrow_forward</span></span>
    </a>
  </div>
</div>
